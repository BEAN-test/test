<!DOCTYPE html>
<html lang="zh-TW">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>TWICE2026</title>

<link rel="apple-touch-icon" href="icon-192.png">
<link rel="apple-touch-icon" sizes="152x152" href="icon-192.png">
<link rel="apple-touch-icon" sizes="180x180" href="icon-192.png">
<link rel="apple-touch-icon" sizes="192x192" href="icon-192.png">
<link rel="icon" type="image/png" sizes="192x192" href="icon-192.png">
<link rel="icon" type="image/png" sizes="512x512" href="icon-512.png">

<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="default">
<meta name="apple-mobile-web-app-title" content="TWICE2026">

<style>
  :root { --primary: #F04E98; --bg: #fdfbfb; --card-bg: #ffffff; --text: #333; --grad: linear-gradient(135deg, #FFAD60, #F04E98); }
  body { font-family: -apple-system, sans-serif; margin:0; background: var(--bg); color: var(--text); padding-bottom: 120px; }
  header { background: var(--grad); color:white; text-align:center; padding:20px 18px 15px; font-weight:bold; position:sticky; top:0; z-index:1000; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
  
  /* æˆå“¡ä¸»é¡Œè‰²èª¿è‰²ç›¤ */
  .member-palette { display: flex; overflow-x: auto; padding: 15px; gap: 12px; background: #fff; border-bottom: 1px solid #eee; }
  .member-dot { width: 34px; height: 34px; border-radius: 50%; border: 2px solid #f0f0f0; flex-shrink: 0; cursor: pointer; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }

  #countdown { background:#222; color:#FFAD60; font-size:1.1em; padding:10px; text-align:center; font-family: monospace; }
  
  .tabs { display: flex; background: white; position: sticky; top: 73px; z-index: 999; border-bottom: 1px solid #ddd; overflow-x: auto; }
  .tab-btn { padding: 14px 15px; border: none; background: none; font-weight: bold; color: #bbb; flex: 1; font-size: 0.85em; white-space: nowrap; }
  .tab-btn.active { color: #F04E98; border-bottom: 3px solid #F04E98; }

  .day-content { display: none; padding: 15px; }
  .day-content.active { display: block; }

  /* å¡ç‰‡è¨­è¨ˆ */
  .event-card { background: var(--card-bg); border-radius: 18px; padding: 18px; margin-bottom: 15px; box-shadow: 0 5px 15px rgba(0,0,0,0.05); position: relative; border-left: 10px solid var(--primary); }
  .edit-area:focus { outline: none; background: #fff0f5; border-radius: 4px; padding: 2px; }
  .info-box { background: #f8f9fa; padding: 12px; border-radius: 10px; font-size: 0.9em; margin-top: 10px; border: 1px solid #f0f0f0; }
  
  /* åŠŸèƒ½æŒ‰éˆ• */
  .route-btn { background: #4285F4; color: white; border: none; width: 100%; padding: 12px; border-radius: 10px; font-weight: bold; margin-bottom: 15px; font-size: 1em; }
  .big-add-btn { background: var(--grad); color: white; border: none; width: 100%; padding: 16px; border-radius: 35px; font-weight: bold; margin-top: 10px; font-size: 1em; }
  .del-btn { position: absolute; right: 10px; top: 10px; color: #ddd; font-size: 1.2em; border:none; background:none; padding: 5px; }

  /* æ¸…å–®æ¨£å¼ */
  .check-item { display: flex; align-items: center; background: white; padding: 14px; border-radius: 12px; margin-bottom: 10px; border-left: 5px solid #FFAD60; }
  .check-item input { width: 22px; height: 22px; margin-right: 15px; }
</style>
</head>
<body>

<header id="main-header">ğŸ­ TWICE 2026 Tokyo Guide</header>

<div class="member-palette" id="global-palette"></div>
<div id="countdown">00D 00:00:00</div>

<div class="tabs">
  <button class="tab-btn active" onclick="showTab('day1', this)">4/25 å…­</button>
  <button class="tab-btn" onclick="showTab('day2', this)">4/26 æ—¥</button>
  <button class="tab-btn" onclick="showTab('day3', this)">4/27 ä¸€</button>
  <button class="tab-btn" onclick="showTab('checklist-tab', this)">æ¸…å–®</button>
  <button class="tab-btn" onclick="showTab('trans-tab', this)">äº¤é€š</button>
</div>

<div id="day1" class="day-content active">
  <button class="route-btn" onclick="openMap('day1')">ğŸ—ºï¸ ç”Ÿæˆä»Šæ—¥è·¯ç·šåœ°åœ–</button>
  <div id="events-day1"></div>
  <button class="big-add-btn" onclick="addEvent('day1')">ï¼‹ æ–°å¢è¡Œç¨‹åœ°é»</button>
</div>

<div id="day2" class="day-content">
  <button class="route-btn" onclick="openMap('day2')">ğŸ—ºï¸ ç”Ÿæˆä»Šæ—¥è·¯ç·šåœ°åœ–</button>
  <div id="events-day2"></div>
  <button class="big-add-btn" onclick="addEvent('day2')">ï¼‹ æ–°å¢è¡Œç¨‹åœ°é»</button>
</div>

<div id="day3" class="day-content">
  <button class="route-btn" onclick="openMap('day3')">ğŸ—ºï¸ ç”Ÿæˆä»Šæ—¥è·¯ç·šåœ°åœ–</button>
  <div id="events-day3"></div>
  <button class="big-add-btn" onclick="addEvent('day3')">ï¼‹ æ–°å¢è¡Œç¨‹åœ°é»</button>
</div>

<div id="checklist-tab" class="day-content">
  <div id="packing-list"></div>
  <button class="big-add-btn" onclick="addItem()">ï¼‹ æ–°å¢æ¸…å–®é …ç›®</button>
</div>

<div id="trans-tab" class="day-content">
  <div id="transport-list"></div>
  <button class="big-add-btn" onclick="addTrans()">ï¼‹ æ–°å¢äº¤é€šå‚™è¨»</button>
</div>

<script>
  const officialColors = ["#F04E98", "#81D4FA", "#C5E1A5", "#F48FB1", "#B39DDB", "#FFB74D", "#80CBC4", "#F5F5F5", "#EF5350", "#64B5F6"];
  
  // é è¨­æ•¸æ“š
  const defaultData = {
    day1: [
      {time: "10:30", loc: "æ¾€è°· Tower Records", addr: "æ±äº¬éƒ½æ¸‹è°·åŒºç¥å—1-22-14", station: "æ¾€è°·ç«™", memo: "å·¨å‹çœ‹æ¿æ‹ç…§"},
      {time: "15:00", loc: "æ–°å¤§ä¹…ä¿éŸ“åœ‹è¡—", addr: "æ–°å¤§ä¹…ä¿é§…", station: "JRå±±æ‰‹ç·š", memo: "TWICE å‘¨é‚Š"},
      {time: "18:00", loc: "æ–°å®¿å®˜æ–¹åº—", addr: "æ–°å®¿é§…", station: "JRæ–°å®¿", memo: "æ‹ç…§å·¡ç¦®"}
    ],
    day2: [
      {time: "13:00", loc: "æ± è¢‹å·¡ç¦®", addr: "æ± è¢‹é§…", station: "JR", memo: "K-BOOKS æƒè²¨"},
      {time: "17:00", loc: "åœ‹ç«‹ç«¶æŠ€å ´", addr: "Japan National Stadium", station: "éƒ½ç‡Ÿå¤§æ±Ÿæˆ¶ç·š", memo: "ğŸ­ TWICE CONCERT"}
    ],
    day3: [
      {time: "09:00", loc: "ç§‹è‘‰åŸæƒè²¨", addr: "ç§‹è‘‰åŸé§…", station: "JR", memo: "æœ€å¾Œæ¡è²·"},
      {time: "12:50", loc: "æˆç”°æ©Ÿå ´", addr: "Narita Airport", station: "Skyliner", memo: "ç™»æ©Ÿå›ç¨‹"}
    ]
  };

  let myTrip = JSON.parse(localStorage.getItem('tw_trip_v8')) || defaultData;
  let myItems = JSON.parse(localStorage.getItem('tw_items_v8')) || ["è­·ç…§èˆ‡é–€ç¥¨", "Candy Bong", "è¡Œå‹•é›»æº", "æ—¥å¹£ç¾é‡‘"];
  let myTrans = JSON.parse(localStorage.getItem('tw_trans_v8')) || ["4/25 06:30 æŠµé”æˆç”°", "iPhone Suica ç›´æ¥æ„Ÿæ‡‰é€²ç«™"];

  // åˆå§‹åŒ–ä¸»é¡Œåˆ‡æ›
  const palette = document.getElementById('global-palette');
  officialColors.forEach((color, i) => {
    const dot = document.createElement('div');
    dot.className = 'member-dot'; dot.style.backgroundColor = color;
    dot.onclick = () => {
      const header = document.getElementById('main-header');
      if(i === 0) {
        document.documentElement.style.setProperty('--primary', '#F04E98');
        header.style.background = 'linear-gradient(135deg, #FFAD60, #F04E98)';
      } else {
        document.documentElement.style.setProperty('--primary', color);
        header.style.background = color;
      }
    };
    palette.appendChild(dot);
  });

  function renderEvents() {
    ['day1', 'day2', 'day3'].forEach(day => {
      const container = document.getElementById('events-' + day);
      container.innerHTML = myTrip[day].map((ev, i) => `
        <div class="event-card">
          <button class="del-btn" onclick="deleteEvent('${day}', ${i})">âœ•</button>
          <div class="edit-area" contenteditable="true" onblur="updateEvent('${day}',${i},'time',this.innerText)">â° ${ev.time}</div>
          <div class="edit-area" style="font-weight:bold; font-size:1.1em; margin:5px 0;" contenteditable="true" onblur="updateEvent('${day}',${i},'loc',this.innerText)">ğŸ“ ${ev.loc}</div>
          <div class="info-box">
            <div>ğŸ  åœ°å€: <span class="edit-area" contenteditable="true" onblur="updateEvent('${day}',${i},'addr',this.innerText)">${ev.addr}</span></div>
            <div style="margin-top:5px;">ğŸš‡ äº¤é€š: <span class="edit-area" contenteditable="true" onblur="updateEvent('${day}',${i},'station',this.innerText)">${ev.station}</span></div>
          </div>
          <div class="edit-area" style="font-size:0.85em; color:#666; margin-top:8px;" contenteditable="true" onblur="updateEvent('${day}',${i},'memo',this.innerText)">ğŸ“ ${ev.memo}</div>
        </div>
      `).join('');
    });
    save();
  }

  function renderOthers() {
    document.getElementById('packing-list').innerHTML = myItems.map((it, i) => `<div class="check-item"><input type="checkbox"><span class="edit-area" contenteditable="true" onblur="myItems[${i}]=this.innerText;save()">${it}</span><span style="margin-left:auto;color:#ddd;" onclick="myItems.splice(${i},1);renderOthers()">âœ•</span></div>`).join('');
    document.getElementById('transport-list').innerHTML = myTrans.map((tr, i) => `<div class="event-card" style="border-left-color:#2196f3;"><div class="edit-area" contenteditable="true" onblur="myTrans[${i}]=this.innerText;save()">${tr}</div><button class="del-btn" onclick="myTrans.splice(${i},1);renderOthers()">âœ•</button></div>`).join('');
    save();
  }

  // è·¯ç·šåœ–åŠŸèƒ½ï¼šå–å‡ºç•¶å¤©åœ°å€ç”Ÿæˆ Google Maps é€£çµ
  function openMap(day) {
    const list = myTrip[day];
    if(list.length === 0) return;
    const base = "https://www.google.com/maps/dir/";
    const path = list.map(e => encodeURIComponent(e.addr)).join('/');
    window.open(base + path, '_blank');
  }

  function updateEvent(d, i, f, v) { myTrip[d][i][f] = v.replace(/â° |ğŸ“ |ğŸ  åœ°å€: |ğŸš‡ äº¤é€š: |ğŸ“ /g, ''); save(); }
  function deleteEvent(d, i) { if(confirm("ç¢ºå®šåˆªé™¤æ­¤è¡Œç¨‹ï¼Ÿ")) { myTrip[d].splice(i, 1); renderEvents(); } }
  function addEvent(d) { myTrip[d].push({time: "12:00", loc: "æ–°åœ°é»", addr: "æ±äº¬", station: "JR", memo: "ç·¨è¼¯å‚™è¨»"}); renderEvents(); }
  function addItem() { myItems.push("æ–°æ¸…å–®é …ç›®"); renderOthers(); }
  function addTrans() { myTrans.push("æ–°äº¤é€šå‚™å¿˜"); renderOthers(); }
  function save() { 
    localStorage.setItem('tw_trip_v8', JSON.stringify(myTrip));
    localStorage.setItem('tw_items_v8', JSON.stringify(myItems));
    localStorage.setItem('tw_trans_v8', JSON.stringify(myTrans));
  }

  function showTab(t, b) {
    document.querySelectorAll('.day-content').forEach(d => d.classList.remove('active'));
    document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
    document.getElementById(t).classList.add('active'); b.classList.add('active');
  }

  setInterval(() => {
    const diff = new Date('2026-04-26T17:00:00+09:00') - new Date();
    const d = Math.floor(diff/86400000), h = Math.floor((diff/3600000)%24), m = Math.floor((diff/60000)%60), s = Math.floor((diff/1000)%60);
    document.getElementById('countdown').innerText = diff > 0 ? `${d}D ${h}:${m}:${s}` : 'ğŸ­ TWICE SHOWTIME!';
  }, 1000);

  renderEvents(); renderOthers();
</script>
</body>
</html>
