<!DOCTYPE html>
<html lang="zh-TW">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>TWICE 2026 Guide</title>

<link rel="apple-touch-icon" href="https://i.imgur.com/W7v5p5E.png">
<link rel="apple-touch-icon" sizes="152x152" href="https://i.imgur.com/W7v5p5E.png">
<link rel="apple-touch-icon" sizes="180x180" href="https://i.imgur.com/W7v5p5E.png">
<link rel="icon" type="image/png" href="https://i.imgur.com/W7v5p5E.png">
<meta name="mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="default">
<meta name="apple-mobile-web-app-title" content="TWICE2026">

<style>
  :root { --primary: #F04E98; --bg: #fdfbfb; --card-bg: #ffffff; --text: #333; --grad: linear-gradient(135deg, #FFAD60, #F04E98); }
  body { font-family: -apple-system, sans-serif; margin:0; background: var(--bg); color: var(--text); padding-bottom: 120px; }
  header { background: var(--grad); color:white; text-align:center; padding:18px; font-weight:bold; position:sticky; top:0; z-index:1000; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
  .member-palette { display: flex; overflow-x: auto; padding: 15px; gap: 12px; background: #fff; border-bottom: 1px solid #eee; }
  .member-dot { width: 32px; height: 32px; border-radius: 50%; border: 2px solid #f0f0f0; flex-shrink: 0; cursor: pointer; }
  #countdown { background:#222; color:#FFAD60; font-size:1em; padding:8px; text-align:center; font-family: monospace; }
  .tabs { display: flex; background: white; position: sticky; top: 71px; z-index: 999; border-bottom: 1px solid #ddd; }
  .tab-btn { padding: 14px; border: none; background: none; font-weight: bold; color: #bbb; flex: 1; outline:none; font-size: 0.85em; }
  .tab-btn.active { color: #F04E98; border-bottom: 3px solid #F04E98; }
  .day-content { display: none; padding: 15px; }
  .day-content.active { display: block; }
  .event-card { background: var(--card-bg); border-radius: 15px; padding: 16px; margin-bottom: 15px; box-shadow: 0 4px 12px rgba(0,0,0,0.05); position: relative; border-left: 10px solid var(--primary); }
  .info-box { background: #f9f9f9; padding: 10px; border-radius: 8px; font-size: 0.85em; margin-bottom: 8px; border: 1px solid #eee; }
  .row { display: flex; align-items: flex-start; margin-bottom: 4px; }
  .icon-label { margin-right: 8px; flex-shrink: 0; width: 20px; text-align: center; }
  .edit-area { flex: 1; min-height: 1.2em; }
  .edit-area:focus { outline: none; background: #fff0f5; border-radius: 2px; }
  .big-add-btn { background: #F04E98; color: white; border: none; width: 100%; padding: 16px; border-radius: 35px; font-weight: bold; margin-top: 10px; }
</style>
</head>
<body>

<header id="main-header">üç≠ TWICE 2026 Tokyo Guide</header>
<div class="member-palette" id="global-palette"></div>
<div id="countdown">00D 00:00:00</div>

<div class="tabs">
  <button class="tab-btn active" onclick="showTab('day1', this)">4/25</button>
  <button class="tab-btn" onclick="showTab('day2', this)">4/26</button>
  <button class="tab-btn" onclick="showTab('day3', this)">4/27</button>
  <button class="tab-btn" onclick="showTab('checklist-tab', this)">üß≥ ÂÇôÂøò</button>
</div>

<div id="day1" class="day-content active"></div>
<div id="day2" class="day-content"></div>
<div id="day3" class="day-content"></div>
<div id="checklist-tab" class="day-content"><div id="packing-list"></div><button class="big-add-btn" onclick="addCheckItem()">Ôºã Êñ∞Â¢ûÁâ©ÂìÅ</button></div>

<div id="color-picker" class="color-picker-overlay" style="display:none; position:fixed; bottom:0; left:0; right:0; background:white; padding:20px 20px 40px; z-index:2000; box-shadow: 0 -5px 20px rgba(0,0,0,0.2); border-radius: 20px 20px 0 0;">
  <div class="picker-grid" id="picker-grid" style="display:grid; grid-template-columns:repeat(5,1fr); gap:15px;"></div>
  <button onclick="closePicker()" style="width:100%; margin-top:20px; padding:15px; border:none; border-radius:10px; background:#eee;">ÂèñÊ∂à</button>
</div>

<script>
  const officialColors = ["#F04E98", "#81D4FA", "#C5E1A5", "#F48FB1", "#B39DDB", "#FFB74D", "#80CBC4", "#F5F5F5", "#EF5350", "#64B5F6"];

  const initialTripData = {
    day1: [
      {time: "06:30", loc: "ÊàêÁî∞Ê©üÂ†¥", addr: "ÊàêÁî∞Ê©üÂ†¥", line: "Skyliner", station: "ÊàêÁî∞Ê©üÂ†¥", memo: "ÊäµÈÅîÊó•Êú¨ ‚úàÔ∏è", color: "#64B5F6"},
      {time: "10:30", loc: "ÊæÄË∞∑Â∑°Á¶Æ", addr: "ÊæÄË∞∑ÂçÄÁ•ûÂçó1-22-14", line: "JR/Âú∞Èêµ", station: "ÊæÄË∞∑Á´ô", memo: "Tower/109/HMV ËøΩÊòü", color: "#81D4FA"},
      {time: "15:00", loc: "Êñ∞Â§ß‰πÖ‰øùÈüìÂúãË°ó", addr: "Êñ∞Â§ß‰πÖ‰øù", line: "JR Â±±ÊâãÁ∑ö", station: "Êñ∞Â§ß‰πÖ‰øùÁ´ô", memo: "ÈüìÊµÅÂë®ÈÇäËàáÁæéÈ£ü", color: "#EF5350"},
      {time: "17:30", loc: "Êñ∞ÂÆøÂÆòÊñπÂ∫ó", addr: "Êñ∞ÂÆø", line: "JR", station: "Êñ∞ÂÆøÁ´ô", memo: "TSUTAYAÂ±ïÁ§∫ÊãçÁÖß", color: "#64B5F6"},
      {time: "20:00", loc: "ÁßãËëâÂéüÈ£ØÂ∫ó", addr: "ÁßãËëâÂéü", line: "JR", station: "ÁßãËëâÂéüÁ´ô", memo: "Ëæ¶ÁêÜÂÖ•‰Ωè‰ºëÊÅØ", color: "#F5F5F5"}
    ],
    day2: [
      {time: "10:00", loc: "ÂéüÂÆøÁ´π‰∏ãÈÄö", addr: "Á•ûÂÆÆÂâç", line: "JR Â±±ÊâãÁ∑ö", station: "ÂéüÂÆøÁ´ô", memo: "ËÅØÂêçÁîúÈªûËàáÊΩÆÊµÅ", color: "#FFB74D"},
      {time: "13:00", loc: "Ê±†Ë¢ãÂ∑°Á¶Æ", addr: "Ê±†Ë¢ã", line: "JR", station: "Ê±†Ë¢ãÁ´ô", memo: "Sunshine City/K-BOOKS", color: "#80CBC4"},
      {time: "17:00", loc: "ÂúãÁ´ãÁ´∂ÊäÄÂ†¥", addr: "ÂúãÁ´ãÁ´∂ÊäÄÂ†¥", line: "ÈÉΩÁáüÂ§ßÊ±üÊà∂Á∑ö", station: "ÂúãÁ´ãÁ´∂ÊäÄÂ†¥Á´ô", memo: "üç≠ TWICE CONCERT", color: "#F04E98"}
    ],
    day3: [
      {time: "09:00", loc: "ÁßãËëâÂéüÊéÉË≤®", addr: "ÁßãËëâÂéü", line: "JR Â±±ÊâãÁ∑ö", station: "ÁßãËëâÂéüÁ´ô", memo: "ÈõªÊ∞£Ë°ó/ÂãïÊº´ÊúÄÂæåÊé°Ë≤∑", color: "#C5E1A5"},
      {time: "11:00", loc: "ÂâçÂæÄÊ©üÂ†¥", addr: "‰∏äÈáéÁ´ô", line: "Skyliner", station: "‰∫¨Êàê‰∏äÈáé", memo: "Ê∫ñÂÇôÂõûÂÆ∂", color: "#F5F5F5"},
      {time: "12:50", loc: "ÊàêÁî∞Ê©üÂ†¥", addr: "ÊàêÁî∞Ê©üÂ†¥", line: "Skyliner", station: "ÊàêÁî∞Ê©üÂ†¥", memo: "ÊäµÈÅîÊ©üÂ†¥Ëæ¶ÊâãÁ∫å ‚úàÔ∏è", color: "#64B5F6"}
    ]
  };

  let myEvents = JSON.parse(localStorage.getItem('twice_trip_v29')) || initialTripData;
  let myItems = JSON.parse(localStorage.getItem('twice_items_v29')) || [{text: "Ë≠∑ÁÖß/ÈñÄÁ•®"}];
  let editingCard = { day: null, index: null };

  const palette = document.getElementById('global-palette');
  officialColors.forEach((color, idx) => {
    const dot = document.createElement('div');
    dot.className = 'member-dot'; dot.style.backgroundColor = color;
    dot.onclick = () => { if(idx === 0) resetTheme(); else setGlobalTheme(color); };
    palette.appendChild(dot);
  });

  function setGlobalTheme(color) { document.documentElement.style.setProperty('--primary', color); document.getElementById('main-header').style.background = color; }
  function resetTheme() { document.documentElement.style.setProperty('--primary', '#F04E98'); document.getElementById('main-header').style.background = 'linear-gradient(135deg, #FFAD60, #F04E98)'; }

  function renderEvents() {
    ['day1', 'day2', 'day3'].forEach(day => {
      const container = document.getElementById(day); if(!container) return;
      container.innerHTML = "";
      myEvents[day].forEach((ev, index) => {
        container.innerHTML += `<div class="event-card" style="border-left-color: ${ev.color}">
          <button style="position:absolute;right:10px;top:10px;border:none;background:none;font-size:1.1em;" onclick="openPicker('${day}', ${index})">üé®</button>
          <div class="row"><span class="icon-label">‚è∞</span><div class="edit-area" contenteditable="true" onblur="updateEvent('${day}',${index},'time',this.innerText)">${ev.time}</div></div>
          <div class="row"><span class="icon-label">üìç</span><div class="edit-area" style="font-weight:bold; font-size:1.1em;" contenteditable="true" onblur="updateEvent('${day}',${index},'loc',this.innerText)">${ev.loc}</div></div>
          <div class="info-box">
            <div class="row"><span class="icon-label">üöá</span><div class="edit-area"><span contenteditable="true" onblur="updateEvent('${day}',${index},'line',this.innerText)">${ev.line}</span> / <span contenteditable="true" onblur="updateEvent('${day}',${index},'station',this.innerText)">${ev.station}</span></div></div>
            <div class="row"><span class="icon-label">üè†</span><div class="edit-area" contenteditable="true" onblur="updateEvent('${day}',${index},'addr',this.innerText)">${ev.addr}</div></div>
          </div>
          <div style="font-size:0.85em; color:#777; padding-left:28px;" contenteditable="true" onblur="updateEvent('${day}',${index},'memo',this.innerText)">${ev.memo}</div>
        </div>`;
      });
    });
    save();
  }

  function renderItems() {
    const list = document.getElementById('packing-list'); list.innerHTML = "";
    myItems.forEach((item, i) => {
      list.innerHTML += `<div class="event-card" style="padding:12px; margin-bottom:10px; display:flex; align-items:center;"><span style="flex:1" contenteditable="true" onblur="updateItemText(${i}, this.innerText)">${item.text}</span><button onclick="deleteItem(${i})" style="border:none;background:none;color:#ccc;">√ó</button></div>`;
    });
    save();
  }

  function updateEvent(d, i, f, v) { myEvents[d][i][f] = v; save(); }
  function updateItemText(i, v) { myItems[i].text = v; save(); }
  function deleteItem(i) { myItems.splice(i,1); renderItems(); }
  function addCheckItem() { myItems.push({text: "Êñ∞È†ÖÁõÆ"}); renderItems(); }
  function save() { localStorage.setItem('twice_trip_v29', JSON.stringify(myEvents)); localStorage.setItem('twice_items_v29', JSON.stringify(myItems)); }
  function showTab(t, b) { document.querySelectorAll('.day-content').forEach(d => d.classList.remove('active')); document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active')); document.getElementById(t).classList.add('active'); b.classList.add('active'); }
  function openPicker(d, i) { editingCard = { day: d, index: i }; document.getElementById('picker-grid').innerHTML = officialColors.map(c => `<div style="width:35px;height:35px;border-radius:50%;background:${c};" onclick="setCardColor('${c}')"></div>`).join(''); document.getElementById('color-picker').style.display = 'block'; }
  function closePicker() { document.getElementById('color-picker').style.display = 'none'; }
  function setCardColor(c) { myEvents[editingCard.day][editingCard.index].color = c; renderEvents(); closePicker(); }

  setInterval(() => {
    const diff = new Date('2026-04-26T17:00:00+09:00') - new Date();
    if(diff > 0) {
      const d = Math.floor(diff/86400000), h = Math.floor((diff/3600000)%24), m = Math.floor((diff/60000)%60), s = Math.floor((diff/1000)%60);
      document.getElementById('countdown').innerText = `${d}D ${h.toString().padStart(2,'0')}:${m.toString().padStart(2,'0')}:${s.toString().padStart(2,'0')}`;
    } else { document.getElementById('countdown').innerText = 'SHOW TIME! üç≠'; }
  }, 1000);

  renderEvents(); renderItems();
</script>
</body>
</html>
