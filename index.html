<!DOCTYPE html>
<html lang="zh-TW">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>TWICE 2026 Tokyo</title>

<link rel="apple-touch-icon" sizes="192x192" href="icon-192.png">
<link rel="apple-touch-icon" sizes="512x512" href="icon-512.png">
<link rel="icon" type="image/png" sizes="192x192" href="icon-192.png">
<link rel="icon" type="image/png" sizes="512x512" href="icon-512.png">

<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="apple-mobile-web-app-title" content="TWICE 2026">

<style>
  :root { --primary: #d6336c; --secondary: #ff85a1; --bg: #f8f9fa; --info: #17a2b8; --map: #4285F4; --address-bg: #fff9db; }
  body { font-family: -apple-system, sans-serif; margin:0; background: var(--bg); padding-bottom: 120px; }
  header { background: var(--primary); color:white; text-align:center; padding:15px; font-weight:bold; position:sticky; top:0; z-index:1000; }
  #countdown { background:#333; color:var(--secondary); font-size:1em; padding:8px; text-align:center; font-family: monospace; }
  
  .tabs { display: flex; background: white; border-bottom: 1px solid #ddd; position: sticky; top: 50px; z-index: 999; }
  .tab-btn { padding: 12px; border: none; background: none; font-weight: bold; color: #666; flex: 1; font-size: 0.85em; }
  .tab-btn.active { color: var(--primary); border-bottom: 3px solid var(--primary); background: #fff0f3; }

  .day-content { display: none; padding: 15px; }
  .day-content.active { display: block; }

  /* è·¯ç·šåœ–æŒ‰éˆ• */
  .route-planner { background: var(--map); color: white; border: none; width: 100%; padding: 12px; border-radius: 10px; font-weight: bold; margin-bottom: 15px; cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 8px; box-shadow: 0 4px 6px rgba(66, 133, 244, 0.3); }

  /* è¡Œç¨‹å¡ç‰‡ */
  .event-card { background: white; border-radius: 12px; padding: 15px; margin-bottom: 15px; box-shadow: 0 3px 10px rgba(0,0,0,0.08); position: relative; border-left: 6px solid var(--info); }
  .event-card.concert { border-left-color: var(--primary); background: #fff0f3; }
  
  .time-tag { font-size: 0.85em; font-weight: bold; color: var(--primary); display: block; }
  .loc-title { font-size: 1.1em; font-weight: bold; color: #222; margin: 5px 0; display: block; }
  
  .address-box { background: var(--address-bg); padding: 8px; border-radius: 6px; font-size: 0.8em; margin-bottom: 8px; color: #856404; border: 1px dashed #ffeeba; }
  .transport-box { background: #f1f3f5; padding: 8px; border-radius: 6px; font-size: 0.85em; margin-bottom: 8px; color: #444; }
  .memo-content { font-size: 0.82em; color: #555; line-height: 1.5; white-space: pre-wrap; background: #fafafa; padding: 8px; border-radius: 4px; }
  
  .del-btn { position: absolute; right: 10px; top: 10px; color: #ccc; border: none; background: none; font-size: 1.2em; }
  .add-area { text-align: center; margin: 20px 15px; }
  .big-add-btn { background: var(--primary); color: white; border: none; width: 100%; padding: 15px; border-radius: 30px; font-weight: bold; }

  [contenteditable="true"]:focus { background: white; outline: 2px solid var(--secondary); border-radius: 4px; }
</style>
</head>
<body>

<header>ğŸ­ TWICE 2026 æ±äº¬è¡Œç¨‹å°èˆª</header>
<div id="countdown">00D 00:00:00</div>

<div class="tabs">
  <button class="tab-btn active" onclick="showTab('checklist-tab', this)">ğŸ§³ è£å‚™</button>
  <button class="tab-btn" onclick="showTab('day1', this)">4/25</button>
  <button class="tab-btn" onclick="showTab('day2', this)">4/26</button>
  <button class="tab-btn" onclick="showTab('day3', this)">4/27</button>
</div>

<div id="checklist-tab" class="day-content active">
  <div id="packing-list">
    <div style="padding:10px; background:white; border-radius:8px; margin-bottom:8px;"><input type="checkbox"> è­·ç…§ & é–€ç¥¨ QR Code</div>
    <div style="padding:10px; background:white; border-radius:8px; margin-bottom:8px;"><input type="checkbox"> Candybong & å‚™ç”¨é›»æ± </div>
  </div>
  <button onclick="addItem()" style="width:100%; padding:12px; background:var(--primary); color:white; border:none; border-radius:8px; font-weight:bold;">ï¼‹ æ–°å¢è£å‚™</button>
</div>

<div id="day1" class="day-content"></div>
<div id="day2" class="day-content"></div>
<div id="day3" class="day-content"></div>

<div class="add-area" id="add-btn-container" style="display:none;">
  <button class="route-planner" onclick="generateDailyRoute()">ğŸ—ºï¸ é–‹å•Ÿä»Šæ—¥è·¯ç·šå°èˆª (Google Maps)</button>
  <button class="big-add-btn" onclick="addNewEvent()">ï¼‹ æ–°å¢è¡Œç¨‹åœ°é»</button>
</div>

<script>
  const initialData = {
    day1: [
      {time: "10:00", loc: "K-spot (æ±äº¬ä¸€ç•ªè¡—)", addr: "æ±äº¬éƒ½åƒä»£ç”°å€ä¸¸ä¹‹å…§1-9-1", station: "æ±äº¬ç«™ å…«é‡æ´²åœ°ä¸‹ä¸­å¤®å£", memo: "å®˜æ–¹è¯åå¿«é–ƒ"},
      {time: "13:00", loc: "K-BOOKS K-POPé¤¨", addr: "æ±äº¬éƒ½è±å³¶å€æ±æ± è¢‹1-28-1", station: "æ± è¢‹ç«™ æ±å£ 35è™Ÿ", memo: "ç¨€æœ‰å°å¡ç‰†"},
      {time: "15:30", loc: "Tower Records æ± è¢‹", addr: "æ±äº¬éƒ½è±å³¶å€æ±æ± è¢‹1-50-35", station: "P'PARCO 6F", memo: "å®˜æ–¹æ‡‰æ´çœ‹æ¿"}
    ],
    day2: [
      {time: "11:00", loc: "Tower Records æ¾€è°·", addr: "æ±äº¬éƒ½æ¾€è°·å€ç¥å—1-22-14", station: "æ¾€è°·ç«™ B1 å‡ºå£", memo: "1F/5F/6F å¿…é€›"},
      {time: "17:00", loc: "ğŸŸï¸ åœ‹ç«‹ç«¶æŠ€å ´", addr: "æ±äº¬éƒ½æ–°å®¿å€éœä¸˜ç”º10-1", station: "åœ‹ç«‹ç«¶æŠ€å ´ç«™", memo: "TWICE CONCERT!", special: "concert"}
    ],
    day3: [
      {time: "10:00", loc: "Seoul Record", addr: "æ±äº¬éƒ½æ–°å®¿å€å¤§ä¹…ä¿1-16-13", station: "æ–°å¤§ä¹…ä¿ç«™", memo: "è€å­—è™Ÿå”±ç‰‡è¡Œ"},
      {time: "11:30", loc: "MOIZA", addr: "æ±äº¬éƒ½æ–°å®¿å€å¤§ä¹…ä¿2-32-2", station: "æ–°å¤§ä¹…ä¿ç«™", memo: "æ‡‰æ´æ£’é…ä»¶"},
      {time: "13:30", loc: "Tower Records æ–°å®¿", addr: "æ±äº¬éƒ½æ–°å®¿å€æ–°å®¿3-37-1", station: "Flags 9F", memo: "åœ˜å“¡ç°½åæ¿"}
    ]
  };

  let myEvents = JSON.parse(localStorage.getItem('twice_v15')) || initialData;
  let activeTab = 'day1';

  function renderEvents() {
    ['day1', 'day2', 'day3'].forEach(day => {
      const container = document.getElementById(day);
      container.innerHTML = "";
      myEvents[day].forEach((ev, index) => {
        container.innerHTML += `
          <div class="event-card ${ev.special || ''}">
            <button class="del-btn" onclick="deleteEvent('${day}', ${index})">Ã—</button>
            <span class="time-tag" contenteditable="true" onblur="updateData('${day}', ${index}, 'time', this.innerText)">â° ${ev.time}</span>
            <span class="loc-title" contenteditable="true" onblur="updateData('${day}', ${index}, 'loc', this.innerText)">ğŸ“ ${ev.loc}</span>
            <div class="address-box">ğŸ  åœ°å€: <span contenteditable="true" onblur="updateData('${day}', ${index}, 'addr', this.innerText)">${ev.addr || ''}</span></div>
            <div class="transport-box">ğŸš‰ <span contenteditable="true" onblur="updateData('${day}', ${index}, 'station', this.innerText)">${ev.station}</span></div>
            <div class="memo-content" contenteditable="true" onblur="updateData('${day}', ${index}, 'memo', this.innerText)">${ev.memo}</div>
          </div>
        `;
      });
    });
    localStorage.setItem('twice_v15', JSON.stringify(myEvents));
  }

  function updateData(day, index, field, value) {
    let clean = value.replace('â° ', '').replace('ğŸ“ ', '').replace('ğŸ  åœ°å€: ', '');
    myEvents[day][index][field] = clean;
    localStorage.setItem('twice_v15', JSON.stringify(myEvents));
  }

  function generateDailyRoute() {
    const events = myEvents[activeTab];
    const addrList = events.map(e => e.addr).filter(a => a && a.trim() !== "");
    
    if (addrList.length < 1) {
      alert("ç•¶æ—¥è¡Œç¨‹ä¸­æ²’æœ‰è¼¸å…¥åœ°å€å–”ï¼");
      return;
    }

    const origin = addrList[0];
    const destination = addrList[addrList.length - 1];
    const waypoints = addrList.slice(1, -1).join('|');
    
    // ä½¿ç”¨ Google Maps Directions URL æ ¼å¼
    let url = `https://www.google.com/maps/dir/?api=1&origin=${encodeURIComponent(origin)}&destination=${encodeURIComponent(destination)}&travelmode=transit`;
    if (waypoints) {
      url += `&waypoints=${encodeURIComponent(waypoints)}`;
    }

    window.open(url, '_blank');
  }

  function addNewEvent() {
    myEvents[activeTab].push({time: "12:00", loc: "æ–°åœ°é»", addr: "", station: "å‡ºå£è³‡è¨Š", memo: "å‚™è¨»å…§å®¹"});
    renderEvents();
  }

  function deleteEvent(day, index) {
    if(confirm("ç¢ºå®šè¦åˆªé™¤å—ï¼Ÿ")) { myEvents[day].splice(index, 1); renderEvents(); }
  }

  function addItem() {
    const val = prompt("è«‹è¼¸å…¥è£å‚™åç¨±:");
    if(!val) return;
    const div = document.createElement('div');
    div.style = "padding:10px; background:white; border-radius:8px; margin-bottom:8px;";
    div.innerHTML = `<input type="checkbox"> ${val}`;
    document.getElementById('packing-list').appendChild(div);
  }

  function showTab(tabId, btn) {
    activeTab = tabId;
    document.querySelectorAll('.day-content').forEach(d => d.classList.remove('active'));
    document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
    document.getElementById(tabId).classList.add('active');
    btn.classList.add('active');
    document.getElementById('add-btn-container').style.display = (tabId === 'checklist-tab') ? 'none' : 'block';
  }

  function updateCountdown() {
    const target = new Date('2026-04-26T17:00:00+09:00');
    const now = new Date();
    const diff = target - now;
    if (diff <= 0) { document.getElementById('countdown').innerText = 'ENJOY THE SHOW! ğŸ­'; return; }
    const d = Math.floor(diff / (1000 * 60 * 60 * 24)).toString().padStart(2, '0');
    const h = Math.floor((diff / (1000 * 60 * 60)) % 24).toString().padStart(2, '0');
    const m = Math.floor((diff / 1000 / 60) % 60).toString().padStart(2, '0');
    const s = Math.floor((diff / 1000) % 60).toString().padStart(2, '0');
    document.getElementById('countdown').innerText = `${d}D ${h}:${m}:${s}`;
  }

  setInterval(updateCountdown, 1000);
  renderEvents();
</script>

</body>
</html>
